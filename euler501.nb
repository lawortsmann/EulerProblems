(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11415,        272]
NotebookOptionsPosition[     11124,        257]
NotebookOutlinePosition[     11477,        273]
CellTagsIndexPosition[     11434,        270]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"N0", "=", 
   SuperscriptBox["10", "12"]}], ";"}]], "Input",
 CellChangeTimes->{{3.631749807375381*^9, 3.631749954825162*^9}, {
   3.631749989163601*^9, 3.631750104728924*^9}, {3.631750138707924*^9, 
   3.631750277383346*^9}, {3.6317503420108557`*^9, 3.631750354786846*^9}, {
   3.6317505165046577`*^9, 3.631750516952395*^9}, {3.631750566966799*^9, 
   3.631750567053781*^9}, 3.631750727866094*^9, {3.6317510437329073`*^9, 
   3.631751046418108*^9}, {3.6317510857626867`*^9, 3.6317510862386312`*^9}, 
   3.631751186363323*^9, {3.631751243413562*^9, 3.631751272061356*^9}, {
   3.631751457278562*^9, 3.6317514703596*^9}, {3.6317515056717587`*^9, 
   3.6317515082228947`*^9}, {3.6317515458922243`*^9, 
   3.6317515680121098`*^9}, {3.63175160161057*^9, 3.631751611843755*^9}, {
   3.631751646173565*^9, 3.631751696694087*^9}, {3.631752285579183*^9, 
   3.631752286378669*^9}, {3.631752625828281*^9, 3.6317526935843563`*^9}, {
   3.631752729329492*^9, 3.63175287738503*^9}, 3.6317531719130898`*^9, {
   3.631753413053609*^9, 3.631753413484275*^9}, {3.631755419182569*^9, 
   3.631755420519615*^9}, 3.631755632387312*^9, {3.631755755984675*^9, 
   3.631755768417281*^9}, {3.631757245160798*^9, 3.631757261745222*^9}, {
   3.631757382984354*^9, 3.631757383495019*^9}, {3.6317576080554028`*^9, 
   3.631757629994969*^9}, 3.6317577457068443`*^9, {3.631758828428379*^9, 
   3.631758828841549*^9}, 3.6317600172803802`*^9, {3.631760180830572*^9, 
   3.631760182073998*^9}, {3.6317609804678802`*^9, 3.631761008355769*^9}, {
   3.631761074445019*^9, 3.631761074575515*^9}, {3.6317613590727158`*^9, 
   3.631761360110732*^9}, {3.631761510506012*^9, 3.6317615106558228`*^9}, {
   3.6317618723989573`*^9, 3.631761878495558*^9}, {3.631762080657359*^9, 
   3.63176212499137*^9}, {3.631762226505344*^9, 3.63176222757384*^9}, {
   3.631762503393626*^9, 3.6317625226252604`*^9}, {3.631762573182498*^9, 
   3.631762575121448*^9}, {3.6317626129244623`*^9, 3.6317626351897984`*^9}, {
   3.631762665835538*^9, 3.6317626668112793`*^9}, {3.631763086785761*^9, 
   3.6317631173839817`*^9}, {3.6317631895504208`*^9, 3.631763211934667*^9}, 
   3.631763822420394*^9, {3.631763969599927*^9, 3.631763970205728*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"it1", "=", 
    RowBox[{"ParallelMap", "[", 
     RowBox[{"Prime", ",", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"PrimePi", "[", 
         SuperscriptBox[
          RowBox[{"(", "N0", ")"}], 
          RowBox[{"1", "/", "3"}]], "]"}], "+", "1"}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"it2", "=", 
    RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"int2range", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PrimePi", "[", 
            RowBox[{"it1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"PrimePi", "[", 
            SqrtBox[
             FractionBox["N0", 
              RowBox[{"it1", "[", 
               RowBox[{"[", "i", "]"}], "]"}]]], "]"}], "+", "2"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"it1", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"Prime", ",", "int2range"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "it1", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evolvef", "[", "num_", "]"}], ":=", 
  RowBox[{"zerof", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"PrimePi", "[", 
        FractionBox["N0", 
         RowBox[{"first", " ", "num"}]], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"PrimePi", "[", "num", "]"}], ")"}], "+", "1"}], ")"}]}], 
      ")"}], "+", "1"}], ")"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zerof", "[", "x_", "]"}], ":=", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {"x", 
          RowBox[{"x", "\[GreaterEqual]", "0"}]},
         {"0", 
          RowBox[{"x", "<", "0"}]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}},
        Selectable->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L1", "=", 
    RowBox[{
    "ParallelSum", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"first", "=", 
        RowBox[{"two", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seconds", "=", 
        RowBox[{"two", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Total", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"evolvef", ",", "seconds"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"two", ",", "it2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"it1a", "=", 
    RowBox[{"(", 
     RowBox[{"Prime", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"PrimePi", "[", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["N0", "2"], ")"}], 
         RowBox[{"1", "/", "3"}]], "]"}], "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L2", "=", 
    RowBox[{"ParallelSum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"p2a", "=", 
        RowBox[{"PrimePi", "[", "cube", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p2b", "=", 
        RowBox[{"PrimePi", "[", 
         FractionBox["N0", 
          SuperscriptBox["cube", "3"]], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"p2a", "\[LessEqual]", "p2b"}], ",", 
         RowBox[{"p2b", "-", "1"}], ",", "p2b"}], "]"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"cube", ",", "it1a"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L3", "=", 
    RowBox[{"PrimePi", "[", 
     SuperscriptBox["N0", 
      RowBox[{"1", "/", "7"}]], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"L1", "+", "L2", "+", "L3"}]}], "Input",
 CellChangeTimes->{{3.63175289465736*^9, 3.631753035865035*^9}, {
   3.631753066778843*^9, 3.6317533861672564`*^9}, {3.6317534573830967`*^9, 
   3.631753484417091*^9}, {3.631753538227406*^9, 3.6317535977067003`*^9}, {
   3.6317536445280437`*^9, 3.631753656569085*^9}, 3.631753811320694*^9, {
   3.6317538622781754`*^9, 3.631753920875595*^9}, {3.631753971937714*^9, 
   3.6317539761205187`*^9}, {3.631754061037076*^9, 3.631754074887383*^9}, {
   3.63175417776038*^9, 3.6317542232723207`*^9}, {3.63175427445809*^9, 
   3.631754333755891*^9}, {3.631754363806073*^9, 3.631754451363714*^9}, 
   3.631754483285549*^9, {3.631754536116765*^9, 3.631754537626298*^9}, {
   3.631754601381165*^9, 3.631754783214362*^9}, {3.6317548467308407`*^9, 
   3.631755045748024*^9}, 3.6317551242205276`*^9, {3.631755312211318*^9, 
   3.631755391863415*^9}, {3.631755431825486*^9, 3.6317554335679903`*^9}, {
   3.631755536914344*^9, 3.6317555515322447`*^9}, {3.631755596363682*^9, 
   3.631755608980714*^9}, {3.631755671959093*^9, 3.6317557356400623`*^9}, 
   3.631755781036195*^9, {3.631755854688511*^9, 3.631755857014778*^9}, {
   3.631755897325121*^9, 3.631755981787346*^9}, {3.63175619965331*^9, 
   3.631756213254574*^9}, {3.631756384446588*^9, 3.631756384571115*^9}, {
   3.6317564249766073`*^9, 3.631756425136593*^9}, 3.631756475280223*^9, {
   3.631756552540225*^9, 3.631756554420186*^9}, {3.631756620371685*^9, 
   3.6317566224186983`*^9}, {3.6317566883795223`*^9, 
   3.6317567132386417`*^9}, {3.631756761552058*^9, 3.63175676375383*^9}, {
   3.6317568275408077`*^9, 3.6317568795034847`*^9}, {3.631756914681734*^9, 
   3.631756962226654*^9}, {3.631756994972986*^9, 3.631756999105281*^9}, {
   3.6317570413652287`*^9, 3.631757081248413*^9}, {3.63175716951931*^9, 
   3.631757203410735*^9}, {3.6317583618948298`*^9, 3.631758381193636*^9}, {
   3.6317588118441353`*^9, 3.6317588122906713`*^9}, {3.631760052298704*^9, 
   3.631760079517683*^9}, {3.6317601285150967`*^9, 3.6317601429639473`*^9}, {
   3.6317608794456253`*^9, 3.6317610003039637`*^9}, {3.631761040012053*^9, 
   3.631761487778379*^9}, {3.631761523657847*^9, 3.6317616230771303`*^9}, {
   3.631761691053043*^9, 3.631761866333727*^9}, 3.6317619757486362`*^9, {
   3.631762012826805*^9, 3.63176201325675*^9}, {3.631762073723199*^9, 
   3.631762089532846*^9}, {3.631762354064204*^9, 3.63176237682615*^9}, {
   3.63176244923462*^9, 3.631762569926486*^9}, {3.631762603852375*^9, 
   3.6317626762718983`*^9}, {3.63176277131218*^9, 3.63176277150167*^9}, {
   3.631762872059675*^9, 3.631762914816453*^9}, 3.631763078695261*^9, {
   3.631763124227397*^9, 3.631763170522093*^9}, {3.6317637437941427`*^9, 
   3.631763761818618*^9}, {3.631763801079914*^9, 3.631763928480419*^9}}]
},
WindowSize->{808, 902},
WindowMargins->{{22, Automatic}, {Automatic, 1}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2217, 32, 32, "Input"],
Cell[2778, 54, 8342, 201, 699, "Input"]
}
]
*)

(* End of internal cache information *)
